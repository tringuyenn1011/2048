{"version":3,"sources":["assets\\Scripts\\game_control.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\n\nimport TileBoard from \"./TileBoard\";\nimport TileState from \"./TileState\";\n\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class game_control extends cc.Component {\n\n    @property(cc.Node) Board_Container: cc.Node = null\n    @property(cc.Node) Game_Over: cc.Node = null\n\n    @property(cc.Label) Score_Number: cc.Label = null\n\n    @property(cc.Label) Best_Number: cc.Label = null\n\n    board: TileBoard;\n    score: number\n\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        \n    }\n\n    start () {\n        this.board = this.Board_Container.getComponent(\"TileBoard\")\n\n        this.score = 0\n        \n        this.NewGame()\n        \n    }\n\n    NewGame()\n    {\n        this.SetScore(0)\n        console.log(this.LoadHighScore().toString())\n        this.Best_Number.string = this.LoadHighScore().toString()\n\n        this.Game_Over.opacity = 0\n        this.Game_Over.active = false\n        this.board.ClearBoard()\n        this.board.CreateTile(2)\n        this.board.CreateTile(2)\n        \n    }\n\n    GameOver()\n    {\n\n        this.Game_Over.active = true\n\n        this.AnimateFate(186, 1000)\n    }\n\n    async AnimateFate(to: number, delay: number)\n    {\n        await this.sleep(delay)\n        let elapsed = 0\n        const duration = 1\n\n        const from = this.Game_Over.opacity\n\n        while(elapsed < duration)\n        {\n            const t = elapsed/duration\n            this.Game_Over.opacity = cc.misc.lerp(from, to, t)\n            elapsed += 1/60\n            await this.sleep(0)\n        }\n\n        this.Game_Over.opacity = to\n\n    }\n\n    sleep(ms: number)\n    {\n        return new Promise(resolve => setTimeout(resolve, ms))\n    }\n\n    SetScore(score: number)\n    {\n        this.score = score\n        this.Score_Number.string = score.toString() \n\n        this.SaveHighScore()\n    }\n\n    IncreaseScore(point: number)\n    {\n        this.SetScore(this.score + point )\n    }\n\n    SaveHighScore()\n    {\n        let highscore = this.LoadHighScore()\n\n        if(this.score > highscore)\n            cc.sys.localStorage.setItem(\"highscore\", this.score)     \n    }\n\n    LoadHighScore()\n    {\n        let highscore = cc.sys.localStorage.getItem(\"highscore\")\n        if(highscore === null)\n            return 0\n        return highscore\n    }\n\n}\n"]}